{"version":3,"sources":["../../../../assets/Script/assets/Script/Boot.js"],"names":["cc","Class","extends","Component","properties","loadingBar","ProgressBar","start","startLoading","InitGameSpark","GSMgr","instance","Init","LoginServer","bind","progress","userId","FBInstantHelper","getPlayerID","authenticationRequest","OnTryLogin","response","error","playerName","getPlayerName","playerPhoto","getPlayerPhoto","registrationRequest","OnTryRegister","EnterRoom","groupId","getContextID","enterRoomRequest","onEnterRoomResponse","console","log","LoadGameScene","director","preloadScene","Finished","loadScene"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAYL,GAAGM;AADP,KAHP;;AAOL;;AAEA;;AAEAC,SAXK,mBAWI;AACL,aAAKC,YAAL;AACH,KAbI;AAeLA,gBAfK,0BAgBL;AACI,aAAKC,aAAL;AACH,KAlBI;AAoBLA,iBApBK,2BAqBL;AACIC,cAAMC,QAAN,CAAeC,IAAf,CAAoB,KAAKC,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAApB;AACA,aAAKT,UAAL,CAAgBU,QAAhB,GAA2B,GAA3B;AACH,KAxBI;AA0BLF,eA1BK,yBA2BL;AACI,aAAKG,MAAL,GAAcC,gBAAgBC,WAAhB,EAAd;AACAR,cAAMC,QAAN,CAAeQ,qBAAf,CAAqC,KAAKH,MAA1C,EAAkD,KAAKA,MAAvD,EAA+D,KAAKI,UAAL,CAAgBN,IAAhB,CAAqB,IAArB,CAA/D;AACH,KA9BI;AAgCLM,cAhCK,sBAgCMC,QAhCN,EAiCL;AACI,YAAIA,SAASC,KAAb,EACA;AACI,gBAAIC,aAAaN,gBAAgBO,aAAhB,EAAjB;AACA,gBAAIC,cAAcR,gBAAgBS,cAAhB,EAAlB;AACAhB,kBAAMC,QAAN,CAAegB,mBAAf,CAAmCJ,UAAnC,EAA+C,KAAKP,MAApD,EAA4D,KAAKA,MAAjE,EAAyES,WAAzE,EAAsF,KAAKG,aAAL,CAAmBd,IAAnB,CAAwB,IAAxB,CAAtF;AACH,SALD,MAOA;AACI,iBAAKe,SAAL;AACH;AACJ,KA5CI;AA8CLD,iBA9CK,yBA8CSP,QA9CT,EA+CL;AACI,YAAI,CAACA,SAASC,KAAd,EACA;AACI,iBAAKO,SAAL;AACH,SAHD,MAKA;AACI;AACH;AACJ,KAxDI;AA0DLA,aA1DK,uBA2DL;AACI,YAAIC,UAAUb,gBAAgBc,YAAhB,EAAd;AACArB,cAAMC,QAAN,CAAeqB,gBAAf,CAAgC,SAAhC,EAA2CF,OAA3C,EAAoD,KAAKG,mBAAL,CAAyBnB,IAAzB,CAA8B,IAA9B,CAApD;AACH,KA9DI;AAgELmB,uBAhEK,+BAgEeZ,QAhEf,EAiEL;AACIa,gBAAQC,GAAR,CAAYd,QAAZ;AACA,YAAI,CAACA,SAASC,KAAd,EACA;AACI,iBAAKc,aAAL;AACH;AACJ,KAvEI;AAyELA,iBAzEK,2BA0EL;AACIpC,WAAGqC,QAAH,CAAYC,YAAZ,CAAyB,MAAzB,EAAiC,KAAKC,QAAtC;AACA,aAAKlC,UAAL,CAAgBU,QAAhB,GAA2B,CAA3B;AACH,KA7EI;AA+ELwB,YA/EK,sBAgFL;AACIvC,WAAGqC,QAAH,CAAYG,SAAZ,CAAsB,MAAtB;AACH;AAlFI,CAAT","file":"Boot.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        loadingBar: cc.ProgressBar,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        this.startLoading();\n    },\n\n    startLoading()\n    {\n        this.InitGameSpark();\n    },\n\n    InitGameSpark()\n    {\n        GSMgr.instance.Init(this.LoginServer.bind(this));\n        this.loadingBar.progress = 0.6;\n    },\n\n    LoginServer()\n    {\n        this.userId = FBInstantHelper.getPlayerID();\n        GSMgr.instance.authenticationRequest(this.userId, this.userId, this.OnTryLogin.bind(this));\n    },\n\n    OnTryLogin(response)\n    {\n        if (response.error)\n        {\n            let playerName = FBInstantHelper.getPlayerName();\n            let playerPhoto = FBInstantHelper.getPlayerPhoto();\n            GSMgr.instance.registrationRequest(playerName, this.userId, this.userId, playerPhoto, this.OnTryRegister.bind(this));\n        }\n        else\n        {\n            this.EnterRoom();\n        }\n    },\n\n    OnTryRegister(response)\n    {\n        if (!response.error)\n        {\n            this.EnterRoom();\n        }\n        else\n        {\n            //pop up error\n        }\n    },\n\n    EnterRoom()\n    {\n        var groupId = FBInstantHelper.getContextID();\n        GSMgr.instance.enterRoomRequest(\"Kill_13\", groupId, this.onEnterRoomResponse.bind(this));\n    },\n\n    onEnterRoomResponse(response)\n    {\n        console.log(response);\n        if (!response.error)\n        {\n            this.LoadGameScene();\n        }\n    },\n\n    LoadGameScene()\n    {\n        cc.director.preloadScene(\"Game\", this.Finished);\n        this.loadingBar.progress = 1;\n    },\n\n    Finished()\n    {\n        cc.director.loadScene(\"Game\");\n    }\n});\n"]}