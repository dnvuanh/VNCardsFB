{"version":3,"sources":["Boot.js"],"names":["cc","Class","extends","Component","properties","loadingBar","ProgressBar","username","EditBox","login","Button","start","userId","FBInstantHelper","isReady","node","active","startLoading","loginButtonClick","quickLoginButtonClick","sender","id","loadResource","ImageCache","Init","LoadSoundGame","bind","progress","SoundMgr","instance","preload","LoadGameScene","director","preloadScene","InitGameSpark","GSMgr","LoginServer","getPlayerID","string","authenticationRequest","OnTryLogin","response","error","playerName","getPlayerName","playerPhoto","getPlayerPhoto","registrationRequest","OnTryRegister","EnterRoom","groupId","getContextID","enterRoomRequest","onEnterRoomResponse","console","log","WaitMatchData","GameMgr","onMatchLoaded","Finished","loadScene"],"mappings":"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","file":"Boot.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        loadingBar: cc.ProgressBar,\r\n        username: cc.EditBox,\r\n        login: cc.Button,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        this.userId = '';\r\n        if(FBInstantHelper.isReady()) {\r\n            this.login.node.active = false;\r\n            this.username.node.active = false;\r\n            this.startLoading();\r\n        }\r\n    },\r\n\r\n    loginButtonClick() {\r\n        this.startLoading();\r\n    },\r\n\r\n    quickLoginButtonClick(sender, id) {\r\n        this.startLoading();\r\n        this.userId = id;\r\n    },\r\n\r\n    startLoading()\r\n    {\r\n        this.loadResource();\r\n    },\r\n\r\n    loadResource()\r\n    {\r\n        ImageCache.Init(this.LoadSoundGame.bind(this));\r\n        this.loadingBar.progress = 0.2;\r\n    },\r\n\r\n    LoadSoundGame()\r\n    {\r\n        SoundMgr.instance.preload(this.LoadGameScene.bind(this));\r\n        this.loadingBar.progress = 0.4;\r\n    },\r\n\r\n    LoadGameScene()\r\n    {\r\n        cc.director.preloadScene(\"Game\", this.InitGameSpark.bind(this));\r\n        this.loadingBar.progress = 0.6;\r\n    },\r\n\r\n    InitGameSpark()\r\n    {\r\n        GSMgr.instance.Init(this.LoginServer.bind(this));\r\n        this.loadingBar.progress = 0.8;\r\n    },\r\n\r\n    LoginServer()\r\n    {      \r\n        if(FBInstantHelper.isReady()) {\r\n            this.userId = FBInstantHelper.getPlayerID();\r\n        } else {\r\n            if(this.userId == '') {\r\n                this.userId = this.username.string;\r\n            }\r\n        }\r\n        GSMgr.instance.authenticationRequest(this.userId, this.userId, this.OnTryLogin.bind(this));\r\n    },\r\n\r\n    OnTryLogin(response)\r\n    {\r\n        if (response.error)\r\n        {\r\n            let playerName = FBInstantHelper.getPlayerName();\r\n            let playerPhoto = FBInstantHelper.getPlayerPhoto();\r\n            if(playerName == \"Mayc\") \r\n            {\r\n                playerName = this.userId;\r\n            }\r\n            GSMgr.instance.registrationRequest(playerName, this.userId, this.userId, playerPhoto, this.OnTryRegister.bind(this));\r\n        }\r\n        else\r\n        {\r\n            this.EnterRoom();\r\n        }\r\n    },\r\n\r\n    OnTryRegister(response)\r\n    {\r\n        if (!response.error)\r\n        {\r\n            this.EnterRoom();\r\n        }\r\n        else\r\n        {\r\n            //pop up error\r\n        }\r\n    },\r\n\r\n    EnterRoom()\r\n    {\r\n        var groupId = FBInstantHelper.getContextID();\r\n        GSMgr.instance.enterRoomRequest(\"Kill_13\", groupId, this.onEnterRoomResponse.bind(this));\r\n    },\r\n\r\n    onEnterRoomResponse(response)\r\n    {\r\n        console.log(response);\r\n        if (!response.error)\r\n        {\r\n            this.WaitMatchData();\r\n        }\r\n    },\r\n\r\n    WaitMatchData() //it's sent automatically when user enter room\r\n    {\r\n        GameMgr.instance.onMatchLoaded(this.Finished.bind(this));\r\n    },\r\n\r\n    Finished()\r\n    {\r\n        this.loadingBar.progress = 1;\r\n        cc.director.loadScene(\"Game\");\r\n    }\r\n});\r\n"]}