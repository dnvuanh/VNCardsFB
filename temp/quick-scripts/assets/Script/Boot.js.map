{"version":3,"sources":["Boot.js"],"names":["cc","Class","extends","Component","properties","loadingBar","ProgressBar","username","EditBox","login","Button","start","userId","FBInstantHelper","isReady","node","active","startLoading","loginButtonClick","quickLoginButtonClick","sender","id","loadResource","ImageCache","Init","InitGameSpark","bind","GSMgr","instance","LoginServer","progress","getPlayerID","string","authenticationRequest","OnTryLogin","response","error","playerName","getPlayerName","playerPhoto","getPlayerPhoto","registrationRequest","OnTryRegister","EnterRoom","groupId","getContextID","enterRoomRequest","onEnterRoomResponse","console","log","WaitMatchData","GameMgr","onMatchLoaded","LoadGameScene","director","preloadScene","Finished","loadScene"],"mappings":"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","file":"Boot.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        loadingBar: cc.ProgressBar,\r\n        username: cc.EditBox,\r\n        login: cc.Button,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        this.userId = '';\r\n        if(FBInstantHelper.isReady()) {\r\n            this.login.node.active = false;\r\n            this.username.node.active = false;\r\n            this.startLoading();\r\n        }\r\n    },\r\n\r\n    loginButtonClick() {\r\n        this.startLoading();\r\n    },\r\n\r\n    quickLoginButtonClick(sender, id) {\r\n        this.startLoading();\r\n        this.userId = id;\r\n    },\r\n\r\n    startLoading()\r\n    {\r\n        this.loadResource();\r\n    },\r\n\r\n    loadResource()\r\n    {\r\n        ImageCache.Init(this.InitGameSpark.bind(this));\r\n    },\r\n\r\n    InitGameSpark()\r\n    {\r\n        GSMgr.instance.Init(this.LoginServer.bind(this));\r\n        this.loadingBar.progress = 0.6;\r\n    },\r\n\r\n    LoginServer()\r\n    {      \r\n        if(FBInstantHelper.isReady()) {\r\n            this.userId = FBInstantHelper.getPlayerID();\r\n        } else {\r\n            if(this.userId == '') {\r\n                this.userId = this.username.string;\r\n            }\r\n        }\r\n        GSMgr.instance.authenticationRequest(this.userId, this.userId, this.OnTryLogin.bind(this));\r\n    },\r\n\r\n    OnTryLogin(response)\r\n    {\r\n        if (response.error)\r\n        {\r\n            let playerName = FBInstantHelper.getPlayerName();\r\n            let playerPhoto = FBInstantHelper.getPlayerPhoto();\r\n            if(playerName == \"Mayc\") \r\n            {\r\n                playerName = this.userId;\r\n            }\r\n            GSMgr.instance.registrationRequest(playerName, this.userId, this.userId, playerPhoto, this.OnTryRegister.bind(this));\r\n        }\r\n        else\r\n        {\r\n            this.EnterRoom();\r\n        }\r\n    },\r\n\r\n    OnTryRegister(response)\r\n    {\r\n        if (!response.error)\r\n        {\r\n            this.EnterRoom();\r\n        }\r\n        else\r\n        {\r\n            //pop up error\r\n        }\r\n    },\r\n\r\n    EnterRoom()\r\n    {\r\n        var groupId = FBInstantHelper.getContextID();\r\n        GSMgr.instance.enterRoomRequest(\"Kill_13\", groupId, this.onEnterRoomResponse.bind(this));\r\n    },\r\n\r\n    onEnterRoomResponse(response)\r\n    {\r\n        console.log(response);\r\n        if (!response.error)\r\n        {\r\n            this.WaitMatchData();\r\n        }\r\n    },\r\n\r\n    WaitMatchData() //it's sent automatically when user enter room\r\n    {\r\n        GameMgr.instance.onMatchLoaded(this.LoadGameScene.bind(this));\r\n    },\r\n\r\n    LoadGameScene()\r\n    {\r\n        cc.director.preloadScene(\"Game\", this.Finished);\r\n        this.loadingBar.progress = 1;\r\n    },\r\n\r\n    Finished()\r\n    {\r\n        cc.director.loadScene(\"Game\");\r\n    }\r\n});\r\n"]}