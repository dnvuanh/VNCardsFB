{"version":3,"sources":["SeatDisplay.js"],"names":["cc","Class","extends","Component","properties","displayNode","Node","avatar","Sprite","userName","Label","money","hostIcon","turnCountDown","ProgressBar","resultIcon","onLoad","active","node","IsMyTurn","display","playerInfo","playerId","id","photo","scriptData","Photo","displayName","ImageCache","loadAvatar","imgSprite","spriteFrame","console","log","string","getPlayerId","remove","setHost","isHost","displayTurn","startTime","timeout","timeStartTurn","timeoutTurnMill","timeEndTurn","disableCountDown","onPlayerFinished","update","dt","timeNow","Date","now","percent","progress","setReady","isReady","opacity"],"mappings":"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","file":"SeatDisplay.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        displayNode: cc.Node,\r\n        avatar: cc.Sprite,\r\n        userName: cc.Label,\r\n        money: cc.Label,\r\n        hostIcon: cc.Node,\r\n        turnCountDown: cc.ProgressBar,\r\n        resultIcon: cc.Node,\r\n    },\r\n\r\n    onLoad()\r\n    {\r\n        this.displayNode.active = false;\r\n        this.hostIcon.active = false;\r\n        this.turnCountDown.node.active = false;\r\n        this.IsMyTurn = false;\r\n        this.resultIcon.active = false;\r\n    },\r\n\r\n    display(playerInfo)\r\n    {\r\n        this.playerId = playerInfo.id;\r\n        let photo = playerInfo.scriptData.Photo;\r\n        let displayName = playerInfo.displayName;\r\n\r\n        ImageCache.loadAvatar(this.playerId, photo, (imgSprite)=>{\r\n            if (imgSprite)\r\n            {\r\n                this.avatar.spriteFrame = imgSprite;\r\n            }\r\n            else\r\n            {\r\n                console.log(\"Error while loading user avatar \" + this.playerId);\r\n            }\r\n            this.userName.string = displayName;\r\n            this.displayNode.active = true;\r\n        });\r\n    },\r\n\r\n    getPlayerId()\r\n    {\r\n        return this.playerId;\r\n    },\r\n\r\n    remove()\r\n    {\r\n        this.playerId = null;\r\n        this.hostIcon.active = false;\r\n        this.displayNode.active = false;\r\n    },\r\n\r\n    setHost(isHost)\r\n    {\r\n        this.hostIcon.active = isHost;\r\n    },\r\n\r\n    displayTurn(startTime, timeout)\r\n    {\r\n        this.turnCountDown.node.active = true;\r\n        this.timeStartTurn = startTime;\r\n        this.timeoutTurnMill = timeout * 1000;\r\n        this.timeEndTurn = this.timeStartTurn + this.timeoutTurnMill;\r\n        this.IsMyTurn = true;\r\n    },\r\n\r\n    disableCountDown()\r\n    {\r\n        this.IsMyTurn = false;\r\n        this.turnCountDown.node.active = false;\r\n    },\r\n\r\n    onPlayerFinished()\r\n    {\r\n        this.resultIcon.active = true;\r\n    },\r\n\r\n    update(dt)\r\n    {\r\n        if (this.IsMyTurn)\r\n        {\r\n            let timeNow = Date.now();\r\n            let percent = (this.timeEndTurn - timeNow) / this.timeoutTurnMill;\r\n            if (percent > 0)\r\n            {\r\n                this.turnCountDown.progress = percent;\r\n            }\r\n            else\r\n            {\r\n                this.IsMyTurn = false;\r\n                this.turnCountDown.progress = 0;\r\n                this.turnCountDown.node.active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    setReady(isReady)\r\n    {\r\n        if (isReady)\r\n        {\r\n            this.node.opacity = 255;\r\n        }\r\n        else\r\n        {\r\n            this.node.opacity = 125;\r\n        }\r\n    }\r\n});\r\n"]}