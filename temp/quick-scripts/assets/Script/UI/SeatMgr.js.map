{"version":3,"sources":["SeatMgr.js"],"names":["cc","Class","extends","Component","start","seats","GameMgr","instance","getCurrentSeats","seat","playerId","playerInfo","getPlayer","onPlayerEnter","host","getHost","setHost","node","children","length","seatDisplay","getComponent","display","setReady","IsHost","id","onPlayerLeave","remove","i","getPlayerId","onTurnChange","startTime","timeout","displayTurn","disableCountDown","stopAllTurn","onPlayerFinished","onPlayerReady","isReady"],"mappings":"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","file":"SeatMgr.js","sourceRoot":"../../../../../assets/Script/UI","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    \n    start()\n    {\n        let seats = GameMgr.instance.getCurrentSeats();\n        for (var seat in seats)\n        {\n            let playerId = seats[seat];\n            if (playerId)\n            {\n                let playerInfo = GameMgr.instance.getPlayer(playerId);\n                this.onPlayerEnter(playerInfo, seat);\n            }\n        }\n        let host = GameMgr.instance.getHost();\n        if (host)\n            this.setHost(host);\n    },\n\n    onPlayerEnter(playerInfo, seat)\n    {\n        if (seat < this.node.children.length)\n        {\n            var seatDisplay = this.node.children[seat].getComponent(\"SeatDisplay\");\n                seatDisplay.display(playerInfo);\n                seatDisplay.setReady(GameMgr.instance.IsHost(playerInfo.id));\n        }\n    },\n\n    onPlayerLeave(seat)\n    {\n        if (seat < this.node.children.length)\n        {\n            var seatDisplay = this.node.children[seat].getComponent(\"SeatDisplay\");\n                seatDisplay.remove();\n        }\n    },\n\n    setHost(playerId)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.setHost(true);\n            }\n            else\n            {\n                seatDisplay && seatDisplay.setHost(false);\n            }\n        }\n    },\n\n    onTurnChange(playerId, startTime, timeout)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.displayTurn(startTime, timeout);\n            }\n            else\n            {\n                seatDisplay.disableCountDown();\n            }\n        }\n    },\n\n    stopAllTurn()\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n                seatDisplay.disableCountDown();\n        }\n    },\n\n    onPlayerFinished(playerId)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.onPlayerFinished();\n            }\n        }\n    },\n\n    onPlayerReady(playerId, isReady)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.setReady(isReady);\n            }\n        }\n    }\n    \n});\n"]}