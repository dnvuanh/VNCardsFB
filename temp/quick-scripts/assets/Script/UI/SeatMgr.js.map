{"version":3,"sources":["SeatMgr.js"],"names":["cc","Class","extends","Component","start","seats","GameMgr","instance","getCurrentSeats","seat","playerId","playerInfo","getPlayer","onPlayerEnter","host","getHost","setHost","node","children","length","seatDisplay","getComponent","display","onPlayerLeave","remove","i","getPlayerId","onTurnChange","startTime","timeout","displayTurn","disableCountDown","stopAllTurn","displayResult","playerWinId","playersCards","displayCards","log","enableResultIcon","hideResultIcon","RecallCards","onPlayerReady","isReady","setReady"],"mappings":"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","file":"SeatMgr.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    \n    start()\n    {\n        let seats = GameMgr.instance.getCurrentSeats();\n        for (var seat in seats)\n        {\n            let playerId = seats[seat];\n            if (playerId)\n            {\n                let playerInfo = GameMgr.instance.getPlayer(playerId);\n                this.onPlayerEnter(playerInfo, seat);\n            }\n        }\n        let host = GameMgr.instance.getHost();\n        if (host)\n            this.setHost(host);\n    },\n\n    onPlayerEnter(playerInfo, seat)\n    {\n        if (seat < this.node.children.length)\n        {\n            var seatDisplay = this.node.children[seat].getComponent(\"SeatDisplay\");\n                seatDisplay.display(playerInfo);\n                //seatDisplay.setReady(GameMgr.instance.IsHost(playerInfo.id));\n        }\n    },\n\n    onPlayerLeave(seat)\n    {\n        if (seat < this.node.children.length)\n        {\n            var seatDisplay = this.node.children[seat].getComponent(\"SeatDisplay\");\n                seatDisplay.remove();\n        }\n    },\n\n    setHost(playerId)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.setHost(true);\n            }\n            else\n            {\n                seatDisplay && seatDisplay.setHost(false);\n            }\n        }\n    },\n\n    onTurnChange(playerId, startTime, timeout)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.displayTurn(startTime, timeout);\n            }\n            else\n            {\n                seatDisplay.disableCountDown();\n            }\n        }\n    },\n\n    stopAllTurn()\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n                seatDisplay.disableCountDown();\n        }\n    },\n\n    displayResult(playerWinId, playersCards)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() != null)\n            {\n                seatDisplay.displayCards(playersCards[seatDisplay.getPlayerId()]);\n                if(seatDisplay.getPlayerId() == playerWinId)\n                {\n                    cc.log(seatDisplay.getPlayerId());\n                    seatDisplay.enableResultIcon(true);\n                }\n            }\n        }\n    },\n\n    hideResultIcon()\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            seatDisplay.enableResultIcon(false);\n            if (seatDisplay && seatDisplay.getPlayerId() != null)\n            {\n                seatDisplay.RecallCards();\n            }\n        }\n    },\n\n    onPlayerReady(playerId, isReady)\n    {\n        for (var i=0; i<this.node.children.length; i++)\n        {\n            var seatDisplay = this.node.children[i].getComponent(\"SeatDisplay\");\n            if (seatDisplay && seatDisplay.getPlayerId() == playerId)\n            {\n                seatDisplay.setReady(isReady);\n            }\n        }\n    }\n    \n});\n"]}